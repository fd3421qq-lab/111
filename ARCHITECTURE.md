# ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ğŸ“ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸‰æ¶ˆå¯¹æˆ˜æ¸¸æˆ                            â”‚
â”‚                    äº‹ä»¶ç³»ç»Ÿæ ¸å¿ƒæ¡†æ¶                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         GameManager (æ¸¸æˆç®¡ç†å™¨)        â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  â€¢ æ¸¸æˆçŠ¶æ€ç®¡ç†                   â”‚  â”‚
        â”‚  â”‚  â€¢ åˆ†æ•°ç³»ç»Ÿ                       â”‚  â”‚
        â”‚  â”‚  â€¢ äº‹ä»¶å›è°ƒç³»ç»Ÿ                   â”‚  â”‚
        â”‚  â”‚  â€¢ æ´»åŠ¨äº‹ä»¶è¿½è¸ª                   â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ åŒ…å«
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          EventBar (äº‹ä»¶æ¡)              â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  â€¢ è¿›åº¦ç®¡ç†                       â”‚  â”‚
        â”‚  â”‚  â€¢ äº‹ä»¶åºåˆ—                       â”‚  â”‚
        â”‚  â”‚  â€¢ äº‹ä»¶è§¦å‘é€»è¾‘                   â”‚  â”‚
        â”‚  â”‚  â€¢ é˜ˆå€¼è®¡ç®—                       â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ ä½¿ç”¨
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       GameEventType (äº‹ä»¶ç±»å‹)          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  â¬†ï¸  GRAVITY_REVERSE              â”‚  â”‚
        â”‚  â”‚  â„ï¸  FROZEN_COLORS                â”‚  â”‚
        â”‚  â”‚  âš¡  COMBO_BONUS                   â”‚  â”‚
        â”‚  â”‚  ğŸš§  OBSTACLE_GENERATE            â”‚  â”‚
        â”‚  â”‚  ğŸš€  SPEED_UP                     â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ æ ¸å¿ƒç±»å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GameEventType   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    (æšä¸¾)        â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ ä½¿ç”¨
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    EventBar      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   (äº‹ä»¶æ¡ç±»)     â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
         â”‚                     â”‚
         â”‚ 1                   â”‚
         â”‚                     â”‚
         â”‚ åŒ…å«                â”‚
         â”‚                     â”‚
         â–¼ 1                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   GameManager    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  (æ¸¸æˆç®¡ç†å™¨)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³ç³»è¯´æ˜**:
- `GameManager` **åŒ…å«** ä¸€ä¸ª `EventBar` å®ä¾‹
- `EventBar` **ä½¿ç”¨** `GameEventType` æšä¸¾
- `GameManager` **ä½¿ç”¨** `GameEventType` æšä¸¾

---

## ğŸ”„ æ•°æ®æµå›¾

### ç©å®¶å¾—åˆ† â†’ äº‹ä»¶è§¦å‘æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç©å®¶æ¶ˆé™¤   â”‚
â”‚   æ–¹å—      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GameManager.addScore()  â”‚
â”‚   å¢åŠ åˆ†æ•°              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EventBar.advanceProgress()    â”‚
â”‚   æ¨è¿›è¿›åº¦æ¡                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€æŸ¥æ˜¯å¦è¾¾åˆ°äº‹ä»¶è§¦å‘é˜ˆå€¼      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ æ˜¯ â”€â”€â”€â”
       â”‚          â–¼
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚ è¿”å›è§¦å‘çš„äº‹ä»¶ç±»å‹          â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚           â”‚
       â”‚           â–¼
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚ GameManager.onEventTriggered()  â”‚
       â”‚    â”‚   å¤„ç†äº‹ä»¶                      â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚           â”‚
       â”‚           â–¼
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚ â€¢ è°ƒç”¨äº‹ä»¶å¤„ç†æ–¹æ³•      â”‚
       â”‚    â”‚ â€¢ è§¦å‘æ³¨å†Œçš„å›è°ƒå‡½æ•°    â”‚
       â”‚    â”‚ â€¢ æ·»åŠ åˆ°æ´»åŠ¨äº‹ä»¶åˆ—è¡¨    â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â”€ å¦ â”€â”€â”€â”
                  â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  ç»§ç»­æ¸¸æˆ    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š EventBar æ ¸å¿ƒæœºåˆ¶

### è¿›åº¦å’Œäº‹ä»¶è§¦å‘æœºåˆ¶

```
è¿›åº¦æ¡: 0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 100

äº‹ä»¶:   E1        E2        E3        E4        E5
        â”‚         â”‚         â”‚         â”‚         â”‚
é˜ˆå€¼:   20        40        60        80        100

è¯´æ˜: 
- å¦‚æœæœ‰ 5 ä¸ªäº‹ä»¶,maxProgress = 100
- æ¯ä¸ªäº‹ä»¶åœ¨ 20, 40, 60, 80, 100 åˆ†æ—¶è§¦å‘
- progressPerEvent = maxProgress / eventSequence.length
```

### è§¦å‘é€»è¾‘

```typescript
// ä¼ªä»£ç 
function advanceProgress(points) {
  currentProgress += points;
  
  // é™åˆ¶æœ€å¤§å€¼
  if (currentProgress > maxProgress) {
    currentProgress = maxProgress;
  }
  
  // è®¡ç®—å½“å‰åº”è§¦å‘çš„äº‹ä»¶ç´¢å¼•
  eventThreshold = (currentEventIndex + 1) * progressPerEvent;
  
  // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°é˜ˆå€¼
  if (currentProgress >= eventThreshold && currentEventIndex < eventSequence.length) {
    triggeredEvent = eventSequence[currentEventIndex];
    currentEventIndex++;
    return triggeredEvent;
  }
  
  return null;
}
```

---

## ğŸ® GameManager çŠ¶æ€æœº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    IDLE     â”‚ â—„â”€â”€â”€â”€â”
â”‚  (ç©ºé—²)     â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
       â”‚ startGame() â”‚
       â–¼             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   PLAYING   â”‚      â”‚
â”‚ (æ¸¸æˆä¸­)    â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
       â”‚             â”‚
       â”œâ”€ pauseGame() â”€â”€â”
       â”‚                â–¼
       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚   PAUSED    â”‚
       â”‚         â”‚   (æš‚åœ)    â”‚
       â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚
       â”‚  resumeGame() â”€â”¤
       â”‚                â”‚
       â–¼                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  GAME_OVER   â”‚        â”‚
â”‚ (æ¸¸æˆç»“æŸ)   â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
       â”‚                â”‚
       â”‚ startGame()    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ç±»è¯¦ç»†è®¾è®¡

### EventBar ç±»

#### å±æ€§
```typescript
class EventBar {
  private currentProgress: number;      // å½“å‰è¿›åº¦
  private maxProgress: number;          // æœ€å¤§è¿›åº¦
  private eventSequence: GameEventType[]; // äº‹ä»¶åºåˆ—
  private currentEventIndex: number;    // å½“å‰äº‹ä»¶ç´¢å¼•
  private progressPerEvent: number;     // æ¯äº‹ä»¶æ‰€éœ€è¿›åº¦
}
```

#### æ ¸å¿ƒæ–¹æ³•
```
advanceProgress(points)
    â”œâ”€ å¢åŠ è¿›åº¦å€¼
    â”œâ”€ é™åˆ¶æœ€å¤§å€¼
    â”œâ”€ æ£€æŸ¥æ˜¯å¦è¾¾åˆ°é˜ˆå€¼
    â””â”€ è¿”å›è§¦å‘çš„äº‹ä»¶ï¼ˆå¦‚æœ‰ï¼‰

getNextEvent()
    â””â”€ è¿”å›ä¸‹ä¸€ä¸ªå¾…è§¦å‘äº‹ä»¶

reset(newSequence?)
    â”œâ”€ é‡ç½®è¿›åº¦ä¸º 0
    â”œâ”€ é‡ç½®äº‹ä»¶ç´¢å¼•
    â””â”€ æ›´æ–°äº‹ä»¶åºåˆ—
```

### GameManager ç±»

#### å±æ€§
```typescript
class GameManager {
  private eventBar: EventBar;                      // äº‹ä»¶æ¡å®ä¾‹
  private gameState: GameState;                    // æ¸¸æˆçŠ¶æ€
  private score: number;                           // åˆ†æ•°
  private activeEvents: Map<GameEventType, ActiveEvent>; // æ´»åŠ¨äº‹ä»¶
  private eventCallbacks: Map<GameEventType, Function[]>; // å›è°ƒå‡½æ•°
}
```

#### æ ¸å¿ƒæ–¹æ³•
```
startGame()
    â”œâ”€ è®¾ç½®çŠ¶æ€ä¸º PLAYING
    â”œâ”€ é‡ç½®åˆ†æ•°ä¸º 0
    â”œâ”€ æ¸…ç©ºæ´»åŠ¨äº‹ä»¶
    â””â”€ é‡ç½®äº‹ä»¶æ¡

addScore(points)
    â”œâ”€ å¢åŠ åˆ†æ•°
    â”œâ”€ æ¨è¿›äº‹ä»¶æ¡
    â””â”€ å¦‚æœè§¦å‘äº‹ä»¶ï¼Œè°ƒç”¨ onEventTriggered()

onEventTriggered(event)
    â”œâ”€ è°ƒç”¨å¯¹åº”çš„å¤„ç†æ–¹æ³•
    â”œâ”€ è§¦å‘æ³¨å†Œçš„å›è°ƒå‡½æ•°
    â””â”€ æ·»åŠ åˆ°æ´»åŠ¨äº‹ä»¶åˆ—è¡¨

onEvent(event, callback)
    â””â”€ æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨

isEventActive(event)
    â””â”€ æ£€æŸ¥äº‹ä»¶æ˜¯å¦åœ¨æ´»åŠ¨åˆ—è¡¨ä¸­
```

---

## ğŸ¯ äº‹ä»¶ç”Ÿå‘½å‘¨æœŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‹ä»¶åˆ›å»º        â”‚
â”‚ (å®šä¹‰åœ¨åºåˆ—ä¸­)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç­‰å¾…è§¦å‘        â”‚
â”‚ (åœ¨åºåˆ—ä¸­æ’é˜Ÿ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ è¿›åº¦è¾¾åˆ°é˜ˆå€¼
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‹ä»¶è§¦å‘        â”‚
â”‚ â€¢ è°ƒç”¨å¤„ç†æ–¹æ³•   â”‚
â”‚ â€¢ æ‰§è¡Œå›è°ƒå‡½æ•°   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‹ä»¶æ¿€æ´»        â”‚
â”‚ (æ·»åŠ åˆ°æ´»åŠ¨åˆ—è¡¨) â”‚
â”‚ â€¢ æŒç»­æ—¶é—´: 30s  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 30ç§’å
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‹ä»¶ç»“æŸ        â”‚
â”‚ (ä»æ´»åŠ¨åˆ—è¡¨ç§»é™¤) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ æ‰©å±•ç‚¹

### 1. æ·»åŠ æ–°äº‹ä»¶ç±»å‹

```typescript
// 1. åœ¨ GameEventType æšä¸¾ä¸­æ·»åŠ 
export enum GameEventType {
  // ç°æœ‰äº‹ä»¶...
  NEW_EVENT = 'NEW_EVENT'  // æ–°äº‹ä»¶
}

// 2. åœ¨ GameManager ä¸­æ·»åŠ å¤„ç†æ–¹æ³•
private handleNewEvent(): void {
  console.log('å¤„ç†æ–°äº‹ä»¶');
  // å®ç°é€»è¾‘
}

// 3. åœ¨ onEventTriggered ä¸­æ·»åŠ  case
case GameEventType.NEW_EVENT:
  this.handleNewEvent();
  break;
```

### 2. è‡ªå®šä¹‰äº‹ä»¶æŒç»­æ—¶é—´

```typescript
// åœ¨ activateEvent æ–¹æ³•ä¸­ä¿®æ”¹
private activateEvent(event: GameEventType, duration: number): void {
  // æ ¹æ®ä¸åŒäº‹ä»¶ç±»å‹è®¾ç½®ä¸åŒæŒç»­æ—¶é—´
  const durations = {
    [GameEventType.COMBO_BONUS]: 30000,    // 30ç§’
    [GameEventType.SPEED_UP]: 20000,       // 20ç§’
    [GameEventType.GRAVITY_REVERSE]: 40000 // 40ç§’
  };
  
  const actualDuration = durations[event] || duration;
  // ...
}
```

### 3. äº‹ä»¶ä¼˜å…ˆçº§ç³»ç»Ÿ

```typescript
interface EventConfig {
  type: GameEventType;
  priority: number;  // æ·»åŠ ä¼˜å…ˆçº§
  duration?: number;
}

// åœ¨äº‹ä»¶è§¦å‘æ—¶è€ƒè™‘ä¼˜å…ˆçº§
function shouldTriggerEvent(event: EventConfig): boolean {
  // æ£€æŸ¥å½“å‰æ´»åŠ¨äº‹ä»¶çš„ä¼˜å…ˆçº§
  // å†³å®šæ˜¯å¦è§¦å‘æ–°äº‹ä»¶
}
```

---

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

### æ—¶é—´å¤æ‚åº¦
- `advanceProgress()`: O(1) - å¸¸æ•°æ—¶é—´
- `getNextEvent()`: O(1) - ç›´æ¥æ•°ç»„è®¿é—®
- `isEventActive()`: O(1) - Map æŸ¥æ‰¾
- `reset()`: O(n) - n ä¸ºäº‹ä»¶åºåˆ—é•¿åº¦

### ç©ºé—´å¤æ‚åº¦
- `EventBar`: O(n) - n ä¸ºäº‹ä»¶åºåˆ—é•¿åº¦
- `GameManager`: O(m) - m ä¸ºæ´»åŠ¨äº‹ä»¶æ•°é‡
- æ€»ä½“: O(n + m)

### ä¼˜åŒ–å»ºè®®
1. äº‹ä»¶åºåˆ—é•¿åº¦æ§åˆ¶åœ¨ 5-10 ä¸ª
2. æ´»åŠ¨äº‹ä»¶æ•°é‡æœ‰é™ï¼ˆé€šå¸¸ < 5ï¼‰
3. ä½¿ç”¨ Map è€Œéæ•°ç»„å­˜å‚¨æ´»åŠ¨äº‹ä»¶ï¼ˆO(1) æŸ¥æ‰¾ï¼‰
4. é¿å…é¢‘ç¹çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²

---

## ğŸ§ª æµ‹è¯•è¦†ç›–

```
EventBar
â”œâ”€ æ„é€ å‡½æ•°æµ‹è¯•
â”‚  â”œâ”€ é»˜è®¤å‚æ•°
â”‚  â”œâ”€ è‡ªå®šä¹‰å‚æ•°
â”‚  â””â”€ è¾¹ç•Œæ¡ä»¶
â”œâ”€ è¿›åº¦ç®¡ç†æµ‹è¯•
â”‚  â”œâ”€ æ­£å¸¸æ¨è¿›
â”‚  â”œâ”€ è¶…å‡ºæœ€å¤§å€¼
â”‚  â””â”€ å¤šæ¬¡æ¨è¿›
â”œâ”€ äº‹ä»¶è§¦å‘æµ‹è¯•
â”‚  â”œâ”€ æ­£å¸¸è§¦å‘
â”‚  â”œâ”€ è¿ç»­è§¦å‘
â”‚  â””â”€ è§¦å‘å®Œæ‰€æœ‰äº‹ä»¶
â””â”€ æŸ¥è¯¢æ–¹æ³•æµ‹è¯•
   â”œâ”€ è¿›åº¦æŸ¥è¯¢
   â”œâ”€ äº‹ä»¶æŸ¥è¯¢
   â””â”€ çŠ¶æ€æŸ¥è¯¢

GameManager
â”œâ”€ æ¸¸æˆçŠ¶æ€æµ‹è¯•
â”‚  â”œâ”€ å¼€å§‹æ¸¸æˆ
â”‚  â”œâ”€ æš‚åœ/æ¢å¤
â”‚  â””â”€ ç»“æŸæ¸¸æˆ
â”œâ”€ åˆ†æ•°ç³»ç»Ÿæµ‹è¯•
â”‚  â””â”€ åˆ†æ•°ä¸äº‹ä»¶è”åŠ¨
â”œâ”€ äº‹ä»¶ç³»ç»Ÿæµ‹è¯•
â”‚  â”œâ”€ äº‹ä»¶è§¦å‘
â”‚  â”œâ”€ äº‹ä»¶å›è°ƒ
â”‚  â””â”€ æ´»åŠ¨äº‹ä»¶è¿½è¸ª
â””â”€ é›†æˆæµ‹è¯•
   â””â”€ å®Œæ•´æ¸¸æˆæµç¨‹
```

---

## ğŸ“š è®¾è®¡æ¨¡å¼

### ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼

1. **è§‚å¯Ÿè€…æ¨¡å¼** (Observer Pattern)
   - äº‹ä»¶å›è°ƒç³»ç»Ÿ
   - GameManager ç›‘å¬äº‹ä»¶è§¦å‘

2. **çŠ¶æ€æ¨¡å¼** (State Pattern)
   - GameState æšä¸¾
   - ä¸åŒçŠ¶æ€ä¸‹çš„è¡Œä¸ºå·®å¼‚

3. **ç­–ç•¥æ¨¡å¼** (Strategy Pattern)
   - ä¸åŒäº‹ä»¶çš„å¤„ç†ç­–ç•¥
   - å¯æ‰©å±•çš„äº‹ä»¶å¤„ç†ç³»ç»Ÿ

4. **å•ä¸€èŒè´£åŸåˆ™** (SRP)
   - EventBar åªè´Ÿè´£è¿›åº¦å’Œäº‹ä»¶åºåˆ—
   - GameManager è´Ÿè´£æ¸¸æˆçŠ¶æ€å’Œåè°ƒ

---

## ğŸ“ æœ€ä½³å®è·µ

### ä»£ç ç»„ç»‡
âœ… æ¸…æ™°çš„æ¨¡å—åˆ†ç¦»  
âœ… å•ä¸€èŒè´£åŸåˆ™  
âœ… æ¥å£ä¸å®ç°åˆ†ç¦»  
âœ… ç±»å‹å®‰å…¨  

### é”™è¯¯å¤„ç†
âœ… å‚æ•°éªŒè¯  
âœ… è¾¹ç•Œæ¡ä»¶æ£€æŸ¥  
âœ… çŠ¶æ€ä¸€è‡´æ€§ä¿è¯  

### å¯ç»´æŠ¤æ€§
âœ… è¯¦ç»†çš„æ–‡æ¡£æ³¨é‡Š  
âœ… æ¸…æ™°çš„å‘½åè§„èŒƒ  
âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–  
âœ… ç‰ˆæœ¬æ§åˆ¶  

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-11-13
